extends ../../layouts/default.pug
include ../../mixins/filter.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/box-actions.pug


block main
  if (role.permissions.includes("songs_view"))
    h1(class="mb-4") Quản lý bài hát 
    .card.mb-3
      .card-header Bộ lọc và Tìm kiếm
      .card-body
        .row
          .col-6 
            +filterStatus(listFilter)
          .col-6
            +search(keyword)
    if (role.permissions.includes("songs_edit"))
      .card.mb-3
        .card-header Hành động
        .card-body()
          +box-actions(`/${prefixAdmin}/songs/change-many-status`, listActions)
    .card.mb-3
      .card-header Danh sách
      .card-body
        if (role.permissions.includes("songs_create"))
          div(class="text-right mb-2")
            a(
              href=`/${prefixAdmin}/songs/create`
              class="btn btn-outline-success"
            ) + Thêm mới
        table.table.table-hover.table-sm
          thead
            tr
              th
                input(
                  type="checkbox"
                  change-status-all
                )
              th STT
              th Hình ảnh
              th Tiêu đề
              if (role.permissions.includes("songs_edit"))
                th Trạng thái
              th Hành động

          tbody
            for item, index in songs
              tr
                td
                  input(
                  type="checkbox"
                  change-status-item
                  value = item.id 
                ) 
                td #{index + 1}
                td
                  img(
                    src= item.avatar
                    alt= item.title
                    width="50px"
                    height="auto"
                  )
                td #{item.title}
                if (role.permissions.includes("songs_edit"))
                  td
                    if(item.status == 'active')
                      button(
                        link =`/${prefixAdmin}/songs/change-status/${item.id}/inactive`
                        class="badge badge-success"
                        button-change-status
                      ) Hoạt động 
                    else 
                      button(
                        link =`/${prefixAdmin}/songs/change-status/${item.id}/active` 
                        class="badge badge-danger"
                        button-change-status 
                      ) Dừng hoạt động 
                td
                  a(
                    class="btn btn-info btn-sm mr-1"
                    href= `/${prefixAdmin}/songs/detail/${item.id}`
                  ) Chi tiết
                  if (role.permissions.includes("songs_edit"))
                    a(
                      class="btn btn-warning btn-sm"
                      href= `/${prefixAdmin}/songs/edit/${item.id}`
                    ) Sửa
                  if (role.permissions.includes("songs_delete"))
                    button(
                      class="btn btn-danger btn-sm ml-1"
                      link-id-button = `/${prefixAdmin}/songs/delete/${item.id}` 
                    ) Xóa
      div(class="mx-auto")
        +pagination(pagination)
